---
dataset:test-1:
  type: sql
  name: google_ads_conversion_rating_gclid
  query: "SELECT \r\n        DISTINCT\r\n        SHA2(gclid_c || cet_timestamp ||
    COALESCE(conversion_name,stage_name), 256) AS uid,\r\n        id,\r\n        gclid_c,\r\n
    \       sobject,\r\n        record_type,\r\n        stage_name,\r\n        conversion_rating,\r\n
    \       cet_timestamp::TIMESTAMP AS cet_timestamp,\r\n        ad_user_data,\r\n
    \       ad_personalization,\r\n        conversion_name,\r\n        edw_publn_id\r\nFROM
    marketing.dm_google_ads_conversion_rating_enhanced\r\nLEFT JOIN (\r\n            SELECT
    \r\n                stage_name, \r\n                conversion_name\r\n            FROM
    share_point_marketing.google_ads_conversion_name_lookup \r\n           ) AS l\r\n
    \       USING(stage_name)\r\nWHERE 1=1\r\nAND gclid_c IS NOT NULL\r\nORDER BY
    cet_timestamp::TIMESTAMP"
  description:
  icon:
  connection: connection:redshift-prod-emnify-dwh
